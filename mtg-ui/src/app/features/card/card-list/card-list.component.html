<main class="page">
  <header class="page-header">
    <div>
      <h1>MTG Card Manager</h1>
      <p class="subtitle">
        Search, add, and manage Magic: The Gathering cards.
      </p>
    </div>
  </header>

  <section class="card-panel">
    <header class="toolbar">
      <h2>MTG Cards</h2>

      <div class="search">
        <input
          type="text"
          placeholder="Search by card name…"
          [value]="query()"
          (input)="query.set($any($event.target).value)"
          (keyup.enter)="onSearch()"
        />
        <button type="button" (click)="onSearch()">Search</button>
        <button class="link" type="button" (click)="resetSearch()">Clear</button>
      </div>
    </header>

    <!-- Add new card -->
    <section class="add-card">
      <h3>Add a new card</h3>
      <div class="add-grid">
        <label>
          Name
          <input
            type="text"
            [value]="newName()"
            (input)="newName.set($any($event.target).value)"
            placeholder="Card name"
          />
        </label>

        <label>
          Set code
          <input
            type="text"
            [value]="newSet()"
            (input)="newSet.set($any($event.target).value)"
            placeholder="e.g. LEA"
          />
        </label>

        <label>
          Type
          <input
            type="text"
            [value]="newType()"
            (input)="newType.set($any($event.target).value)"
            placeholder="Artifact, Creature…"
          />
        </label>

        <label>
          Mana
          <input
            type="number"
            [value]="newMana() ?? ''"
            (input)="newMana.set($any($event.target).valueAsNumber)"
            min="0"
          />
        </label>

        <label>
          Price
          <input
            type="number"
            [value]="newPrice() ?? ''"
            (input)="newPrice.set($any($event.target).valueAsNumber)"
            min="0"
            step="0.01"
          />
        </label>

        <label>
          Stock
          <input
            type="number"
            [value]="newStock() ?? ''"
            (input)="newStock.set($any($event.target).valueAsNumber)"
            min="0"
          />
        </label>

        <div class="add-btn-cell">
          <button type="button" class="primary" (click)="addCard()">
            Add Card
          </button>
        </div>
      </div>
    </section>

    <!-- List / detail table -->
    @if (filtered().length > 0) {
      <div class="table-wrapper">
        <table class="grid">
          <thead>
            <tr>
              <th>#</th>
              <th>Set</th>
              <th>Name</th>
              <th>Type</th>
              <th>Mana</th>
              <th class="num">Price</th>
              <th class="num">Stock</th>
            </tr>
          </thead>
          <tbody>
            @for (card of filtered(); track card.cardNumber) {
              <app-card-detail [item]="card"></app-card-detail>
            }
          </tbody>
        </table>
      </div>
    } @else {
      <p class="empty">No cards found.</p>
    }
  </section>
</main>
